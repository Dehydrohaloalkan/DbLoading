# 1. Видение и границы (Vision & Scope)

## 1.1. Цель

**DbLoading** — клиент‑серверное приложение для выгрузки данных из **DB2** по заранее подготовленным SQL‑скриптам, выбранным пользователем. Результат сохраняется на диске на стороне сервера в виде файлов, нарезанных по **10 MiB**. В будущем будет добавлена запись этих файлов во внешний “поток” (stream).

## 1.2. Ключевые свойства

- **Кроссплатформенность сервера**: .NET **10** (Core) — запуск на Debian и Windows.
- **Клиент**: Angular **21** + PrimeNG **21**, аккуратный Material‑style UI с карточками.
- **Аутентификация “через БД”**: если сервер смог подключиться к DB2 с указанными учётными данными — пользователь считается вошедшим и может запускать выгрузки.
- **Скрипты лежат в репозитории**: SQL файлы в папке `scripts/`.
- **Логические группы/скрипты описаны конфигом**: физически варианты `.sql` лежат “плоско” в `scripts/`, без подпапок.
- **Один логический скрипт = 3 SQL варианта** (3 файла), выполняются вместе; результаты сохраняются **в разные файлы**. Пользователь об этом знать не обязан.
- **Модификация SELECT**: по умолчанию `SELECT "LineFile" ...`. При выборе колонок приложение **заменяет** `SELECT "LineFile"` на `SELECT <склейка выбранных выражений через '|'>`.

## 1.3. In/Out of scope (на текущую версию)

### In scope

- UI логина (5 полей) + JWT (access 20 мин, refresh 4 часа, refresh в HttpOnly cookie)
- Выбор групп/скриптов в UI и запуск:
  - запуск одной группы
  - запуск всех групп
  - внутри группы можно включать/выключать логические скрипты (но “запуск отдельного скрипта кнопкой” не нужен)
- Выполнение SQL в DB2 (на старте — допустима заглушка подключения, реальное подключение будет добавлено позже вручную)
- Прогресс/статусы выполнения с синхронизацией клиент↔сервер (SignalR)
- Выгрузка результатов на диск:
  - папки на диске по группе/скрипту
  - нарезка по 10 MiB
  - пустой результат → не создавать файлов, статус `NoData`
- “Observer” (наблюдатель) на события запуска/завершения (для расширений)

### Out of scope (но предусмотрено архитектурой)

- Реальная запись во внешний stream с гарантированной доставкой (будет заглушка + контракты/точки расширения)
- Горизонтальное масштабирование сервера (предполагается 1 инстанс)
- Микросервисы (строго **не используются**)

## 1.4. Основные риски/допущения

- SQL‑парсинг: предполагается, что запросы начинаются с `SELECT "LineFile" ...` (возможны переносы/пробелы). Если шаблон не распознан — запрос считается **немодифицируемым** (поведение фиксируется в документах/логах).
- Формат строк при склейке: разделитель `|`, значения экранируются (см. `06-config-format.md`).
- Нарезка по размеру: **ни один файл не должен превышать 10 MiB**; строка не разрывается, “не влезла” → переносится целиком в следующий файл.

