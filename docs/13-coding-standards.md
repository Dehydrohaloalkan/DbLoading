# 13. Общие правила и стандарты

## 13.1. Репозиторий и структура

- В корне:
  - `src/` — исходники backend
  - `web/` — исходники frontend
  - `scripts/` — SQL файлы (плоско)
  - `config/` — JSON конфиги
  - `docs/` — документация
- Не хранить секреты в репозитории:
  - DB пароли
  - ключи JWT
  - приватные сертификаты

## 13.2. Backend (.NET)

- Layering: API/Application/Domain/Infrastructure.
- DTO ≠ Domain model (не тянуть доменные сущности в API).
- `CancellationToken` во всех длительных операциях (особенно DB2 чтение и запись на диск).
- Логирование структурированное, без секретов.
- SignalR сообщения — небольшие, без бинарных данных/файлов.

## 13.3. Frontend (Angular)

- Использовать Angular CLI для генерации:
  - компоненты, сервисы, модули, guards
- Держать типы DTO синхронизированными с backend контрактом.
- Интерцептор для access token + refresh‑flow.
- UI:
  - карточки, аккуратные отступы
  - явная индикация статусов

## 13.4. Конфиги и совместимость

- Конфиги версионировать:
  - добавить `configVersion` (опционально) или миграции на стороне сервера.
- Любое изменение формата — документировать в `docs/`.

## 13.5. Тестируемость

- Уметь запускать core‑пайплайн без DB2:
  - заглушка DB2 возвращает строки
  - проверяем нарезку, статусы, observer

## 13.6. Ошибки и UX

- Ошибки DB/IO не прятать:
  - скрипт → `Failed`
  - показывать краткий message в UI
  - подробности — в server logs

